/*******************************(C) COPYRIGHT 2013 PLUS - H.****************************************/
/* processor 	    : CORETEX-M3(STM32F207)         		    				                                 */
/* compiler       : EWARM Compiler								                                                 */
/* program by	    : H. H. Hwang									                                                   */
/* History:											                                                                   */
/* 11/10/2013     : Version 1.0									                                                   */
/* copy right	    : PLUS - H.									                                                     */
/****************************************************************************************************/

#ifndef __UART3_H__
#define __UART3_H__

//=======================================================================
void uart3_frame_proc(void);

void UART3_initial(void);
void UART3_tx_check(void);
void UART3_rxd_check(void);
void led_setup(unsigned char index);
void basic_data_execution(unsigned char index);
unsigned char cb_first_send_check(void);
void cb_suncha_send(void);
void cb_command_send(unsigned char index, unsigned char send_cmd);
void priority_pc_send(unsigned char cb_id);

void cb_null_send(void);    //h@20141219

//=======================================================================

#define debug_sp1

//=======================================================================
//=======================================================================

//=======================================================================

#ifdef __UART3_C__
#define u3EX 

//     XY   XY     XY   XY     XY   XY     XY   XY     XY   XY     XY   XY     XY   XY     XY   XY
const  u8 b_room_led_position_table[32][128][3] ={
  {                                                                                                   //31 ~ 35 
        {0x00,0x01,0x02},{0x10,0x11,0x12},{0x20,0x21,0x22},{0x30,0x31,0x32},{0x40,0x41,0x42},{0x50,0x51,0x52},{0x60,0x61,0x62},{0x70,0x71,0x72},  //1~8호
        {0x80,0x81,0x82},{0x90,0x91,0x92},{0xa0,0xa1,0xa2},                                                                                      //9~11호                                                                                                                                                                                                                                                                                                     //51~52*/
  }, //0번 DTC 11ea
  {
        {0x00,0x01,0x02},{0x10,0x11,0x12},{0x20,0x21,0x22},{0x30,0x31,0x32},{0x40,0x41,0x42},{0x50,0x51,0x52},{0x60,0x61,0x62},{0x70,0x71,0x72},  //1~8호
        {0x80,0x81,0x82},{0x90,0x91,0x92},{0xa0,0xa1,0xa2},                                                                                       //9~11호
  }, //1번 DTC 11ea
  {
        {0x00,0x01,0x02},{0x10,0x11,0x12},{0x20,0x21,0x22},{0x30,0x31,0x32},{0x40,0x41,0x42},{0x50,0x51,0x52},{0x60,0x61,0x62},{0x70,0x71,0x72},  //1~8호
        {0x80,0x81,0x82},{0x90,0x91,0x92},{0xa0,0xa1,0xa2},{0xb0,0xb1,0xb2},                                                                      //9~12호
  }, //2번 DTC 12ea
  {
        {0x00,0x01,0x02},{0x10,0x11,0x12},{0x20,0x21,0x22},{0x30,0x31,0x32},{0x40,0x41,0x42},{0x50,0x51,0x52},{0x60,0x61,0x62},{0x70,0x71,0x72},  //1~8호
        {0x80,0x81,0x82},{0x90,0x91,0x92},{0xa0,0xa1,0xa2},{0xb0,0xb1,0xb2},{0xc0,0xc1,0xc2},                                                     //9~13호
  }, //3번 DTC 13ea
  {
        {0x00,0x01,0x02},{0x10,0x11,0x12},{0x20,0x21,0x22},{0x30,0x31,0x32},{0x40,0x41,0x42},{0x50,0x51,0x52},{0x60,0x61,0x62},{0x70,0x71,0x72},  //1~8호
        {0x80,0x81,0x82},{0x90,0x91,0x92},{0xa0,0xa1,0xa2},{0xb0,0xb1,0xb2},{0xc0,0xc1,0xc2},                                                     //9~13호
  }, //4번 DTC 13ea
  {
        {0x00,0x01,0x02},{0x10,0x11,0x12},{0x20,0x21,0x22},{0x30,0x31,0x32},{0x40,0x41,0x42},{0x50,0x51,0x52},{0x60,0x61,0x62},{0x70,0x71,0x72},  //1~8호
        {0x80,0x81,0x82},{0x90,0x91,0x92},{0xa0,0xa1,0xa2},{0xb0,0xb1,0xb2},{0xc0,0xc1,0xc2},                                                     //9~13호
  }, //5번 DTC 13ea
  {
        {0x00,0x01,0x02},{0x10,0x11,0x12},{0x20,0x21,0x22},{0x30,0x31,0x32},{0x40,0x41,0x42},{0x50,0x51,0x52},{0x60,0x61,0x62},{0x70,0x71,0x72},  //1~8호
        {0x80,0x81,0x82},{0x90,0x91,0x92},{0xa0,0xa1,0xa2},{0xb0,0xb1,0xb2},{0xc0,0xc1,0xc2},                                                     //9~13호
  }, //6번 DTC 13ea
  {
        {0x00,0x01,0x02},{0x10,0x11,0x12},{0x20,0x21,0x22},{0x30,0x31,0x32},{0x40,0x41,0x42},{0x50,0x51,0x52},{0x60,0x61,0x62},{0x70,0x71,0x72},  //1~8호
        {0x80,0x81,0x82},{0x90,0x91,0x92},{0xa0,0xa1,0xa2},{0xb0,0xb1,0xb2},{0xc0,0xc1,0xc2},                                                     //9~13호
  }, //7번 DTC 13ea
  {
        {0x00,0x01,0x02},{0x10,0x11,0x12},{0x20,0x21,0x22},{0x30,0x31,0x32},{0x40,0x41,0x42},{0x50,0x51,0x52},{0x60,0x61,0x62},{0x70,0x71,0x72},  //1~8호
        {0x80,0x81,0x82},{0x90,0x91,0x92},{0xa0,0xa1,0xa2},{0xb0,0xb1,0xb2},{0xc0,0xc1,0xc2},                                                     //9~13호
  }, //8번 DTC 13ea
  {
        {0x00,0x01,0x02},{0x10,0x11,0x12},{0x20,0x21,0x22},{0x30,0x31,0x32},{0x40,0x41,0x42},{0x50,0x51,0x52},{0x60,0x61,0x62},{0x70,0x71,0x72},  //1~8호
        {0x80,0x81,0x82},{0x90,0x91,0x92},{0xa0,0xa1,0xa2},{0xb0,0xb1,0xb2},{0xc0,0xc1,0xc2},                                                     //9~13호
  }, //9번 DTC 13ea
  {
        {0x00,0x01,0x02},{0x10,0x11,0x12},{0x20,0x21,0x22},{0x30,0x31,0x32},{0x40,0x41,0x42},{0x50,0x51,0x52},{0x60,0x61,0x62},{0x70,0x71,0x72},  //1~8호
        {0x80,0x81,0x82},{0x90,0x91,0x92},{0xa0,0xa1,0xa2},{0xb0,0xb1,0xb2},{0xc0,0xc1,0xc2},                                                     //9~13호
  }, //10번 DTC 13ea
  {
        {0x00,0x01,0x02},{0x10,0x11,0x12},{0x20,0x21,0x22},{0x30,0x31,0x32},{0x40,0x41,0x42},{0x50,0x51,0x52},{0x60,0x61,0x62},{0x70,0x71,0x72},  //1~8호
        {0x80,0x81,0x82},{0x90,0x91,0x92},{0xa0,0xa1,0xa2},{0xb0,0xb1,0xb2},{0xc0,0xc1,0xc2},                                                     //9~13호
  }, //11번 DTC 13ea
  {
        {0x00,0x01,0x02},{0x10,0x11,0x12},{0x20,0x21,0x22},{0x30,0x31,0x32},{0x40,0x41,0x42},{0x50,0x51,0x52},{0x60,0x61,0x62},{0x70,0x71,0x72},  //1~8호
        {0x80,0x81,0x82},{0x90,0x91,0x92},{0xa0,0xa1,0xa2},{0xb0,0xb1,0xb2},{0xc0,0xc1,0xc2},                                                     //9~13호
  }, //12번 DTC 13ea
  {
        {0x00,0x01,0x02},{0x10,0x11,0x12},{0x20,0x21,0x22},{0x30,0x31,0x32},{0x40,0x41,0x42},{0x50,0x51,0x52},{0x60,0x61,0x62},{0x70,0x71,0x72},  //1~8호
        {0x80,0x81,0x82},{0x90,0x91,0x92},{0xa0,0xa1,0xa2},{0xb0,0xb1,0xb2},{0xc0,0xc1,0xc2},                                                     //9~13호
  }, //13번 DTC 13ea
  {
        {0x00,0x01,0x02},{0x10,0x11,0x12},{0x20,0x21,0x22},{0x30,0x31,0x32},{0x40,0x41,0x42},{0x50,0x51,0x52},{0x60,0x61,0x62},{0x70,0x71,0x72},  //1~8호
        {0x80,0x81,0x82},{0x90,0x91,0x92},{0xa0,0xa1,0xa2},{0xb0,0xb1,0xb2},{0xc0,0xc1,0xc2},                                                     //9~13호
  }, //14번 DTC 13ea
  {
        {0x00,0x01,0x02},{0x10,0x11,0x12},{0x20,0x21,0x22},{0x30,0x31,0x32},{0x40,0x41,0x42},{0x50,0x51,0x52},{0x60,0x61,0x62},{0x70,0x71,0x72},  //1~8호
        {0x80,0x81,0x82},{0x90,0x91,0x92},{0xa0,0xa1,0xa2},{0xb0,0xb1,0xb2},{0xc0,0xc1,0xc2},                                                     //9~13호
  }, //15번 DTC 13ea
  {
        {0x00,0x01,0x02},{0x10,0x11,0x12},{0x20,0x21,0x22},{0x30,0x31,0x32},{0x40,0x41,0x42},{0x50,0x51,0x52},{0x60,0x61,0x62},{0x70,0x71,0x72},  //1~8호
        {0x80,0x81,0x82},{0x90,0x91,0x92},{0xa0,0xa1,0xa2},{0xb0,0xb1,0xb2},{0xc0,0xc1,0xc2},                                                     //9~13호
  }, //16번 DTC 13ea  
};




#else

#define u3EX extern

#endif
u3EX u8 cb_rx_room_data_buf[64][100];
u3EX u8 cb_tx_room_data_buf[64][100];
//[0] = 전송 Flag(명령어의 종류)
//[1] = 
u3EX u8 uart3_tx_data_buf[100];
u3EX u8 uart3_tx_length;
u3EX u8 uart3_tx_backup;
u3EX u8 sub_call_id;
u3EX u8 uart3_rxding_point;
u3EX u8 uart3_rxding_buf[100];
u3EX u8 uart3_rxd_buf[100];
u3EX u8 uart3_rx_length;
u3EX u8 cb_first_check_point;
u3EX u8 priority_pc_send_save_point;
u3EX u8 priority_pc_send_check_point;
u3EX u8 priority_pc_send_buffer[100];

u3EX u8 tx_send_id_back;
u3EX u8 common_send_count;
u3EX u8 tx_delay_timer;


u3EX __wbits uart3_flag;
#define f_uart3_send_time		uart3_flag.s.b0
#define f_uart3_data_send		uart3_flag.s.b1
#define f_uart3_com_start		uart3_flag.s.b2
#define f_uart3_frame_rx_ok uart3_flag.s.b3
#define f_power_on_start    uart3_flag.s.b4
#define f_null_send         uart3_flag.s.b5   //h@20141219
#define f_uart3_delay_time	uart3_flag.s.b6


#endif

//=======================================================================
//=======================================================================

